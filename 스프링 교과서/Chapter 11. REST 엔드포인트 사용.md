# Chapter 11. REST 엔드포인트 사용

- 웹 앱의 클라이언트는 백엔드를 호출할 수 있으며, 다른 백엔드 컴포넌트도 호출할 수 있다.

> 스프링 앱에서 REST 엔드포인트를 호출하는 세 가지 방법
> - OpenFeign: 스프링 클라우드 프로젝트에서 제공하는 도구다. 새 앱에서 REST 엔드포인트를 사용할 때 이 기능을 추천한다.
> - RestTemplate: 스프링 3부터 개발자들이 REST 엔드포인트를 호출하는 데 사용하여 널리 알려진 도구로, 오늘날 스프링 앱에서 자주 쓴다. OpenFeign이 RestTemplate보다 더 좋은 대안이므로 OpenFeign을 사용할 가능성이 높다.
> - WebClient: RestTemplate의 대안으로 제시된 스프링 기능이다. 이 기능은 리액티브 프로그래밍이라는 다른 프로그래밍 방식을 사용한다.

## 11.1 스프링 클라우드 OpenFeign으로 REST 엔드포인트 호출

- OpenFeign을 사용하면 인터페이스만 작성한다. 이 도구가 인터페이스의 구현을 제공한다.
- OpenFeign을 위해 특별히 따로 무언가를 배울 필요는 없고, 스프링 MVC 컨트롤러 클래스에서 REST 엔드포인트를 노출할 때와 동일한 어노테이션을 사용하기만 하면 된다.

## 11.2 RestTemplate으로 REST 엔드포인트 호출

> 개발자들은 다음과 같이 RestTemplate으로 구현하기 어려운 기능을 활용하기 위해 RestTemplate이 아닌 다른 개발 방식을 채택한 것.
> - 엔드포인트를 동기 및 비동기식으로 모두 호출하기
> - 더 적은 코드 작성 및 더 적은 예외 처리(상용구 코드 제거)
> - 호출 실행 재시도 및 폴백 작업(앱이 어떤 이유로 특정 REST 호출을 실행할 수 없을 때 수행되는 대체 로직) 구현

- 코드를 재사용하고 상용구 코드를 피하는 것이 프레임워크의 주요 목적 중 하나이다.

> 어떤 기술이 '지원 종료(deprecated)' 또는 '레거시(legacy)'라고 해서 반드시 배우지 말아야 한다는 것은 아니다. 더 이상 지원되지 않는 기술이라도 수년이 지난 후 여전히 프로젝트에서 사용되는 경우가 있다.

## 11.3 WebClient로 REST 엔드포인트 호출

- 리액티브 방식이라는 방법론을 기반으로 한다.
- 리액티브가 아닌 앱에서는 스레드가 비즈니스 흐름(business flow)을 실행한다.
- 비즈니스 흐름은 여러 태스크로 구성되지만 이 태스크들은 상호 독립적이지 않으며 동일 스레드가 이 플로를 구성하는 모든 태스크를 실행한다.
- 리액티브 앱은 하나의 스레드가 끝까지 모든 태스크를 실행하는 하나의 원자적 흐름 개념을 바꾼다.
- 리액티브 앱에서는 태스크를 독립적인 것으로 간주하고 여러 스레드와 협업하여 여러 태스크로 구성된 비즈니스 흐름을 완료할 수 있다.
- 기술적으로 리액티브 앱에서는 태스크와 태스크 간 의존 관계를 정의하여 비즈니스 흐름을 구현한다.
- 리액티브 앱의 명세에서는 태스크 간 의존 관계를 구현하고자 생산자(producer)와 구독자(subscriber)라는 두 가지 구성 요소를 제공한다.

## 11.4 요약

- 실제 백엔드 솔루션에서는 다른 백엔드 앱이 노출한 엔드포인트를 한 백엔드 앱이 호출해야할 때가 많다.
- 스프링은 REST 서비스의 클라이언트 측을 구현하는 데 필요한 여러 솔루션을 제공한다.
  - OpenFeign: 스프링 클라우드 프로젝트에서 제공된 솔루션. REST 엔드포인트를 호출하기 위해 작성해야 하는 코드를 간소화하고 오늘날 서비스 구현 방식과 관련된 다양한 기능을 추가한다.
  - RestTemplate: 스프링 앱에서 REST 엔드포인트를 호출하는 데 사용되는 간단한 도구다.
  - WebClient: 스프링 앱에서 REST 엔드포인트를 호출하는 리액티브 솔루션이다.
- 새롭게 구현할 곳에서 RestTemplate을 사용해서는 안 된다.
- 표준(리액티브가 아닌) 방식을 따르는 앱이 선택할 수 있는 가장 좋은 방법은 OpenFeign을 사용하는 것이다.
- WebClient는 리액티브 방식으로 설계된 앱을 위한 훌륭한 도구다. 하지만 사용하기 전에 리액티브 방식과 스프링에서 리액티브 앱의 구현 방법을 깊이 이해해야 한다.