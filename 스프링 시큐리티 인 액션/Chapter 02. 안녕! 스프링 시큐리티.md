# Chapter 02. 안녕! 스프링 시큐리티

## 2.1 첫 번째 프로젝트 시작

- 스프링 부트는 @SpringBootApplication 어노테이션이 지정된 클래스가 포함된 패키지(및 하위 패키지)의 구성 요소만 검색한다. 주 패키지 외부에서 스프링의 스테레오타입 어노테이션을 지정하려면 @ComponentScan 어노테이션으로 위치를 명시적으로 선언해야 한다.

> - HTTP 401 권한 없음 상태 코드는 권한 부여 실패보다는 인증 실패를 나타낸다.
> - 권한 부여 실패는 HTTP 403 금지됨 상태를 이용하는 것이 좋을 것이다. 일반적으로 이 응답은 서버가 요청의 호출자를 식별했지만 이 호출자에게 이용 권리가 없다는 의미다.

## 2.2 기본 구성이란?

- 사용자에 관한 세부 정보는 스프링 시큐리티로 UserDetailsService 계약을 구현하는 객체가 관리한다.

> - 스프링 부트가 제공하는 기본 구현은 애플리케이션의 내부 메모리에 기본 자격 증명을 등록하는 일만 한다.
> - 이러한 기본 자격 증명에서 사용자 이름은 'user'이고 기본 암호는 UUID(Universally Unique Identifier) 형식이며 암호는 스프링 컨텍스트가 로드될 때 자동으로 생성된다.
> - 자격 증명을 메모리에 보관하며 애플리케이션은 이 자격 증명을 보존하지 않는다. 그러므로 운영 단계 애플리케이션에서는 피해야하는 방법이다.

- UserDetailsService의 기본 구현을 대체할 때는 PasswordEncoder도 지정해야한다.

> HTTP Basic 인증은 자격 증명의 기밀성을 보장하지 않는다. 일반적으로 최소한의 기밀을 위해 HTTPS를 함께 이용할 때가 아니면 HTTP Basic 인증은 이용하지 않는다.

- AuthenticationProvider는 인증 논리를 정의하고 사용자와 암호의 관리를 위임한다.
- AuthenticationProvider의 기본 구현은 UserDetailsService 및 PasswordEncoder에 제공된 기본 구현을 이용한다.

## 2.3 기본 구성 재정의

- 프로젝트의 구성은 여러 방법으로 재정의하며 유연하한 프로젝트로 만들 수 있는데, 유연성을 남용해서는 안된다.

### 2.3.1 UserDetailsService 구성 요소 재정의

> 자바의 인터페이스는 객체 간의 계약을 정의하며 애플리케이션의 클래스 디자인에서 서로를 이용하는 개체를 분리하는 역할을 한다.

### 2.3.2 엔드포인트 권한 부여 구성 재정의

- WebSecurityConfigurerAdapter 클래스를 상속받아 configure 메소드를 재정의하여 사용한다.(지원 중단됨)

### 2.3.3 다른 방법으로 구성 설정

- 지원 중단된 방식.

### 2.3.4 AuthenticationProvider 구현 재정의

### 2.3.5 프로젝트의 여러 구성 클래스 사용

- 항상 한 클래스가 하나의 책임을 맡도록 하는 것이 바람직하다.

## 요약

- 스프링 시큐리티를 애플리케이션의 종속성으로 추가하면 스프링 부트가 약간의 기본 구성을 제공한다.
- User 클래스로 사용자를 정의할 수 있다. 사용자는 이름, 암호, 권한을 가져야 한다. 권한은 사용자 애플리케이션의 컨텍스트에서 수행할 수 있는 작업을 지정한다.
- AuthenticationProvider 계약을 이용해 애플리케이션의 맞춤형 논리를 구현할 수 있다.
- 구성을 작성하는 방법은 여러가지가 있지만, 한 애플리케이션에서는 한 방법을 고수해야 코드를 깔끔하고 이해하기 쉽게 만들 수 있다.
